!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}(self.webpackChunkassignment_ui=self.webpackChunkassignment_ui||[]).push([[985],{9985:function(t,a,o){"use strict";o.r(a),o.d(a,{VendorManagementModule:function(){return W}});var n=o(9153),i=o(4577),s=o(9582),p=o(3606),l=o(8370),c=o(3534),d=o(2870),u=o(6274);function v(e,t){if(1&e&&(p.TgZ(0,"div",11),p.TgZ(1,"p",8),p._uU(2),p.qZA(),p.qZA()),2&e){var r=p.oxw(2);p.xp6(2),p.Oqu(r.vendor_detail.workflow_status)}}function _(e,t){if(1&e&&(p.TgZ(0,"div",1),p.TgZ(1,"div",2),p.TgZ(2,"div",3),p.TgZ(3,"div",4),p.TgZ(4,"div",5),p._uU(5),p.qZA(),p.qZA(),p.qZA(),p.TgZ(6,"div",6),p.TgZ(7,"div",7),p.TgZ(8,"p",8),p._uU(9,"Vendor Information"),p.qZA(),p.TgZ(10,"a",9),p._UZ(11,"i",10),p._uU(12," Manage Workflow"),p.qZA(),p.qZA(),p.TgZ(13,"div",11),p.TgZ(14,"ul",12),p.TgZ(15,"li"),p.TgZ(16,"p",13),p._uU(17,"Vendor"),p.qZA(),p.TgZ(18,"p",14),p._uU(19),p.qZA(),p.qZA(),p.TgZ(20,"li"),p.TgZ(21,"p",13),p._uU(22,"Created On"),p.qZA(),p.TgZ(23,"p",14),p._uU(24),p.ALo(25,"date"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.YNc(26,v,3,1,"div",15),p.qZA(),p.qZA(),p.qZA()),2&e){var r=p.oxw();p.xp6(5),p.Oqu(r.vendor_tag),p.xp6(5),p.MGl("routerLink","/portal/application/vendors/workflow-detail/",r.vendor_detail._id,""),p.xp6(9),p.Oqu(r.vendor_detail.vendor_name),p.xp6(5),p.Oqu(p.xi3(25,5,r.vendor_detail.created_at,"medium")),p.xp6(2),p.Q6J("ngIf",r.vendor_detail.workflow_status)}}var f=function(){var t=function(){function t(){e(this,t),this.vendor_tag="",this._reInitialize=new s.xQ}return r(t,[{key:"ngOnInit",value:function(){var e=this;this._reInitialize.subscribe(function(t){if(t){e.vendor_detail=t;var r=t.vendor_name.split(" ");e.vendor_tag=r.length>1?"".concat(r[0].charAt(0)).concat(r[1].charAt(0)):"".concat(r[0].charAt(0))}})}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-vendor-detail"]],inputs:{_reInitialize:"_reInitialize"},decls:1,vars:1,consts:[["class","data-container",4,"ngIf"],[1,"data-container"],[1,"row"],[1,"col-md-3","col-sm-12","text-center","col-no-padding"],[1,"display-picture"],[1,"rounded-circle","avatar-xl","default-dp"],[1,"col-md-9","col-sm-12","col-no-padding"],[1,"section-wrapper","mb-4"],[1,"section-heading"],[1,"btn-datatable-2",3,"routerLink"],[1,"mdi","mdi-pencil","mdi-18px"],[1,"col-sm-12","mb-4","col-no-padding"],[1,"meta-data-list"],[1,"label"],[1,"main-menu"],["class","col-sm-12 mb-4 col-no-padding",4,"ngIf"]],template:function(e,t){1&e&&p.YNc(0,_,27,8,"div",0),2&e&&p.Q6J("ngIf",t.vendor_detail)},directives:[u.O5,i.yS],pipes:[u.uU],styles:[""]}),t}();function g(e,t){if(1&e){var r=p.EpF();p.TgZ(0,"tr",10),p.NdJ("click",function(){var e=p.CHM(r).$implicit;return p.oxw().showDetails(e)}),p.TgZ(1,"td"),p._uU(2),p.qZA(),p.TgZ(3,"td"),p._uU(4),p.qZA(),p.TgZ(5,"td"),p._uU(6),p.ALo(7,"date"),p.qZA(),p.qZA()}if(2&e){var a=t.$implicit,o=t.index;p.xp6(2),p.Oqu(o+1),p.xp6(2),p.Oqu(a.vendor_name),p.xp6(2),p.Oqu(p.xi3(7,3,a.created_at,"medium"))}}var Z=function(){var t=function(){function t(r){e(this,t),this._vendorProvider=r,this.reInitialize=new s.xQ,this.headerArray=[{label:"Sl No.",additional_class:"sl_no"},{label:"Vendor",additional_class:""},{label:"Created On",additional_class:""}]}return r(t,[{key:"ngOnInit",value:function(){}},{key:"handleEmitterData",value:function(e){this.vendorsList=e,this.showDetails(e[0])}},{key:"showDetails",value:function(e){this.reInitialize.next(e)}}]),t}();return t.\u0275fac=function(e){return new(e||t)(p.Y36(l.mq))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-vendor"]],decls:14,vars:5,consts:[["header","",1,"card-header"],["routerLink","/portal/application/vendors/create-vendor",1,"btn","btn-with-icon"],[1,"mdi","mdi-plus","mr-2"],["body","",1,"card-body"],[1,"row"],[1,"col-md-4","col-sm-12","col-no-padding"],[3,"_id","_header","_serviceObject","_reocords"],["ngFor","",3,"ngForOf"],[1,"col-md-8","col-sm-12","col-no-padding","col-divider"],[3,"_reInitialize"],[3,"click"]],template:function(e,t){1&e&&(p.TgZ(0,"app-ui-card"),p.TgZ(1,"div",0),p.TgZ(2,"h3"),p._uU(3,"Vendors"),p.qZA(),p.TgZ(4,"a",1),p._UZ(5,"i",2),p._uU(6," Create Vendor"),p.qZA(),p.qZA(),p.TgZ(7,"div",3),p.TgZ(8,"div",4),p.TgZ(9,"div",5),p.TgZ(10,"app-ui-datatable",6),p.NdJ("_reocords",function(e){return t.handleEmitterData(e)}),p.YNc(11,g,8,6,"ng-template",7),p.qZA(),p.qZA(),p.TgZ(12,"div",8),p._UZ(13,"app-vendor-detail",9),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&e&&(p.xp6(10),p.Q6J("_id","vendors-table")("_header",t.headerArray)("_serviceObject",t._vendorProvider),p.xp6(1),p.Q6J("ngForOf",t.vendorsList),p.xp6(2),p.Q6J("_reInitialize",t.reInitialize.asObservable()))},directives:[c.A,i.yS,d.n,u.sg,f],pipes:[u.uU],styles:[""]}),t}(),h=o(9409),m=function(){var t=function(){function t(){e(this,t)}return r(t,[{key:"ngOnInit",value:function(){}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-vendor-management"]],decls:2,vars:0,template:function(e,t){1&e&&(p.TgZ(0,"app-ui-wrapper"),p._UZ(1,"router-outlet"),p.qZA())},directives:[h.A,i.lC],styles:[""]}),t}(),A=o(4988);function q(e,t){if(1&e&&(p.TgZ(0,"th",6),p._uU(1),p.qZA()),2&e){var r=t.$implicit;p.Q6J("ngClass",r.additional_class),p.xp6(1),p.Oqu(r.label)}}function w(e,t){if(1&e&&(p.ynx(0),p.TgZ(1,"thead"),p.TgZ(2,"tr"),p.YNc(3,q,2,2,"ng-template",5),p.qZA(),p.qZA(),p.BQk()),2&e){var r=p.oxw();p.xp6(3),p.Q6J("ngForOf",r.headerArray)}}function T(e,t){if(1&e){var r=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td",7),p.TgZ(2,"div",8),p.TgZ(3,"input",9),p.NdJ("click",function(e){return p.CHM(r),p.oxw().selectRow(e)}),p.qZA(),p._UZ(4,"label",10),p.qZA(),p.qZA(),p.TgZ(5,"td"),p._uU(6),p.qZA(),p.TgZ(7,"td"),p._uU(8),p.ALo(9,"titlecase"),p.qZA(),p.qZA()}if(2&e){var a=t.$implicit,o=p.oxw();p.xp6(3),p.hYB("id","assign-",o._title,"-approvers-",a._id,""),p.s9C("value",a._id),p.xp6(1),p.hYB("for","assign-",o._title,"-approvers-",a._id,""),p.xp6(2),p.Oqu(a.full_name),p.xp6(2),p.Oqu(p.lcZ(9,7,a.role))}}var y=function(){var t=function(){function t(r){e(this,t),this._userProvider=r,this.assignData=[],this.totalRecords=0,this._contextLabel="",this.contectText="user selected",this._datatableContainer="group-options col-no-padding",this._title="",this._approversArray=new p.vpe,this.headerArray=[{label:"",additional_class:"select-row"},{label:"Full Name",additional_class:""},{label:"Role",additional_class:""}]}return r(t,[{key:"ngAfterViewInit",value:function(){var e=this;this._userProvider.listRequest().subscribe(function(t){t.error?(e.dataList=!1,e.totalRecords=0,e.contectText="record found"):(e.dataList=t.data,e.totalRecords=t.data.length,e.contectText=e.totalRecords>1?"records found":"record found")})}},{key:"selectRow",value:function(e){e.target.checked?this.assignData.push(e.target.value):this.assignData.splice(this.assignData.indexOf(e.target.value),0),this._approversArray.emit(this.assignData.join(","))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(p.Y36(l.fz))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-ui-data-selection"]],inputs:{_title:"_title"},outputs:{_approversArray:"_approversArray"},decls:8,vars:4,consts:[[1,"group-title"],[1,"section-heading"],["data-simplebar","",3,"ngClass"],[1,"table","datatable-grid"],[4,"ngIf"],["ngFor","",3,"ngForOf"],["scope","col",3,"ngClass"],[1,"select-row"],[1,"custom-control","custom-checkbox"],["type","checkbox",1,"custom-control-input",3,"id","value","click"],[1,"custom-control-label",3,"for"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p.TgZ(1,"label",1),p._uU(2),p.qZA(),p.qZA(),p.TgZ(3,"div",2),p.TgZ(4,"table",3),p.YNc(5,w,4,1,"ng-container",4),p.TgZ(6,"tbody"),p.YNc(7,T,10,9,"ng-template",5),p.qZA(),p.qZA(),p.qZA()),2&e&&(p.xp6(2),p.hij("Assign ",t._title," Approvers"),p.xp6(1),p.Q6J("ngClass",t._datatableContainer),p.xp6(2),p.Q6J("ngIf",t.headerArray.length>0),p.xp6(2),p.Q6J("ngForOf",t.dataList))},directives:[u.mk,u.O5,u.sg],pipes:[u.rS],styles:[""]}),t}(),b=function(){var t=function(){function t(r,a,o){e(this,t),this._vendorProvider=r,this._router=a,this._elementRef=o,this.formGroup=new A.cw({vendor_name:new A.NI(""),sequential_approvers:new A.NI(""),round_robin_approvers:new A.NI(""),any_one_approvers:new A.NI("")})}return r(t,[{key:"ngAfterViewInit",value:function(){}},{key:"validateForm",value:function(){var e=this;$("#vendor-form").parsley().validate({group:"fieldset-0"})&&this._vendorProvider.createVendor(this.formGroup.value).subscribe(function(t){t.error||e._router.navigate(["/portal/application/vendors"])})}},{key:"handleEmitter",value:function(e,t){var r,a,o,n=document.createEvent("Event");n.initEvent("input",!0,!0),this.formGroup.patchValue((o=e,(a=t)in(r={})?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r)),this._elementRef.nativeElement.querySelector("#".concat(t)).dispatchEvent(n)}},{key:"cancelForm",value:function(){$("#user-form").parsley().reset(),this.formGroup.reset()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(p.Y36(l.mq),p.Y36(i.F0),p.Y36(p.SBq))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-create-vendor"]],decls:31,vars:4,consts:[["header","",1,"card-header"],["body","",1,"card-body"],["id","vendor-form","autocomplete","off",3,"formGroup"],[1,"row"],[1,"col-md-9","col-sm-12","form-container"],[1,"section-wrapper","mb-6"],[1,"section-heading"],[1,"form-row","mb-4"],[1,"form-group","col-md-4"],["for","vendor_name",1,"label","required"],["type","text","id","vendor_name","formControlName","vendor_name","placeholder","Enter Vendor Name","data-parsley-required","true","data-parsley-group","fieldset-0",1,"form-control"],[1,"form-row","mb-8"],[1,"form-group","sequential_approvers","col-md-4"],[3,"_title","_approversArray"],["type","text","id","sequential_approvers","formControlName","sequential_approvers","data-parsley-required","true","data-parsley-group","fieldset-0","data-parsley-class-handler",".sequential_approvers",2,"display","none"],[1,"form-group","round_robin_approvers","col-md-4"],["type","text","id","round_robin_approvers","formControlName","round_robin_approvers","data-parsley-required","true","data-parsley-group","fieldset-0","data-parsley-class-handler",".round_robin_approvers",2,"display","none"],[1,"form-group","any_one_approvers","col-md-4"],["type","text","id","any_one_approvers","formControlName","any_one_approvers","data-parsley-required","true","data-parsley-group","fieldset-0","data-parsley-class-handler",".any_one_approvers",2,"display","none"],[1,"text-right"],["type","button",1,"btn","btn-primary","mr-5px",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(e,t){1&e&&(p.TgZ(0,"app-ui-card"),p.TgZ(1,"div",0),p.TgZ(2,"h3"),p._uU(3,"Create New Vendor"),p.qZA(),p.qZA(),p.TgZ(4,"div",1),p.TgZ(5,"form",2),p.TgZ(6,"div",3),p.TgZ(7,"div",4),p.TgZ(8,"div",5),p.TgZ(9,"p",6),p._uU(10,"Vendor Information"),p.qZA(),p.qZA(),p.TgZ(11,"div",7),p.TgZ(12,"div",8),p.TgZ(13,"label",9),p._uU(14,"Vendor Name"),p.qZA(),p._UZ(15,"input",10),p.qZA(),p.qZA(),p.TgZ(16,"div",11),p.TgZ(17,"div",12),p.TgZ(18,"app-ui-data-selection",13),p.NdJ("_approversArray",function(e){return t.handleEmitter(e,"sequential_approvers")}),p.qZA(),p._UZ(19,"input",14),p.qZA(),p.TgZ(20,"div",15),p.TgZ(21,"app-ui-data-selection",13),p.NdJ("_approversArray",function(e){return t.handleEmitter(e,"round_robin_approvers")}),p.qZA(),p._UZ(22,"input",16),p.qZA(),p.TgZ(23,"div",17),p.TgZ(24,"app-ui-data-selection",13),p.NdJ("_approversArray",function(e){return t.handleEmitter(e,"any_one_approvers")}),p.qZA(),p._UZ(25,"input",18),p.qZA(),p.qZA(),p.TgZ(26,"div",19),p.TgZ(27,"button",20),p.NdJ("click",function(){return t.validateForm()}),p._uU(28,"Create Vendor"),p.qZA(),p.TgZ(29,"button",21),p.NdJ("click",function(){return t.cancelForm()}),p._uU(30,"Cancel"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&e&&(p.xp6(5),p.Q6J("formGroup",t.formGroup),p.xp6(13),p.Q6J("_title","Sequential"),p.xp6(3),p.Q6J("_title","Round Robin"),p.xp6(3),p.Q6J("_title","Any One"))},directives:[c.A,A._Y,A.JL,A.sg,A.Fj,A.JJ,A.u,y],styles:[""]}),t}();function x(e,t){if(1&e&&(p.TgZ(0,"h3"),p._uU(1),p.qZA()),2&e){var r=p.oxw();p.xp6(1),p.hij("Vendor #",r._vendorData._id,"")}}function k(e,t){if(1&e&&(p.TgZ(0,"div",17),p.TgZ(1,"p",19),p._uU(2),p.qZA(),p.qZA()),2&e){var r=t.$implicit;p.xp6(2),p.Oqu(r.full_name)}}function U(e,t){if(1&e&&(p.TgZ(0,"div",17),p.TgZ(1,"p",19),p._uU(2),p.qZA(),p.qZA()),2&e){var r=t.$implicit;p.xp6(2),p.Oqu(r.full_name)}}function O(e,t){if(1&e&&(p.TgZ(0,"div",17),p.TgZ(1,"p",19),p._uU(2),p.qZA(),p.qZA()),2&e){var r=t.$implicit;p.xp6(2),p.Oqu(r.full_name)}}function J(e,t){if(1&e&&(p.TgZ(0,"div",14),p.TgZ(1,"div",15),p.TgZ(2,"div",8),p.TgZ(3,"p",16),p._uU(4),p.qZA(),p.TgZ(5,"div",17),p.TgZ(6,"p",18),p._uU(7,"Created On"),p.qZA(),p.TgZ(8,"p",19),p._uU(9),p.ALo(10,"date"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(11,"div",15),p.TgZ(12,"div",8),p.TgZ(13,"p",16),p._uU(14,"Sequential Approvers"),p.qZA(),p.YNc(15,k,3,1,"ng-template",20),p.qZA(),p.qZA(),p.TgZ(16,"div",15),p.TgZ(17,"div",8),p.TgZ(18,"p",16),p._uU(19,"Round-robin Approvers"),p.qZA(),p.YNc(20,U,3,1,"ng-template",20),p.qZA(),p.qZA(),p.TgZ(21,"div",15),p.TgZ(22,"div",8),p.TgZ(23,"p",16),p._uU(24,"Any one Approvers"),p.qZA(),p.YNc(25,O,3,1,"ng-template",20),p.qZA(),p.qZA(),p.qZA()),2&e){var r=p.oxw();p.xp6(4),p.Oqu(r._vendorData.vendor_name),p.xp6(5),p.Oqu(p.xi3(10,5,r._vendorData.created_at,"medium")),p.xp6(6),p.Q6J("ngForOf",r._vendorData.sequential_approvers),p.xp6(5),p.Q6J("ngForOf",r._vendorData.round_robin_approvers),p.xp6(5),p.Q6J("ngForOf",r._vendorData.any_one_approvers)}}function N(e,t){if(1&e&&(p.TgZ(0,"option",27),p._uU(1),p.qZA()),2&e){var r=t.$implicit;p.Q6J("value",r),p.xp6(1),p.Oqu(r)}}function I(e,t){if(1&e){var r=p.EpF();p.TgZ(0,"td"),p.TgZ(1,"select",25),p.NdJ("change",function(e){p.CHM(r);var t=p.oxw(2).$implicit;return p.oxw(3).updateLog(e,t.type)}),p.YNc(2,N,2,2,"option",26),p.qZA(),p.qZA()}if(2&e){var a=p.oxw(5);p.xp6(2),p.Q6J("ngForOf",a._actions)}}function L(e,t){if(1&e&&(p.TgZ(0,"td"),p._uU(1),p.qZA()),2&e){var r=p.oxw().$implicit;p.xp6(1),p.Oqu(r.approval_action)}}function Y(e,t){if(1&e&&(p.TgZ(0,"td"),p._uU(1),p.qZA()),2&e){var r=p.oxw().$implicit;p.xp6(1),p.Oqu(r.approval_action)}}function Q(e,t){if(1&e&&(p.TgZ(0,"td"),p._uU(1),p.qZA()),2&e){var r=p.oxw().$implicit;p.xp6(1),p.Oqu(r.approval_action)}}function C(e,t){if(1&e&&(p.TgZ(0,"td"),p._uU(1),p.qZA()),2&e){var r=p.oxw().$implicit;p.xp6(1),p.Oqu(r.approval_action)}}function R(e,t){if(1&e&&(p.TgZ(0,"tr"),p.TgZ(1,"td"),p._uU(2),p.qZA(),p.YNc(3,I,3,1,"ng-template",21),p.YNc(4,L,2,1,"ng-template",21),p.YNc(5,Y,2,1,"ng-template",21),p.YNc(6,Q,2,1,"ng-template",21),p.YNc(7,C,2,1,"ng-template",21),p.TgZ(8,"td"),p._uU(9),p.qZA(),p.qZA()),2&e){var r=t.$implicit,a=p.oxw().$implicit,o=p.oxw(3);p.xp6(2),p.Oqu(r.user),p.xp6(1),p.Q6J("ngIf","--"===r.approval_action&&o._currUser===r._id&&r.access),p.xp6(1),p.Q6J("ngIf","--"===r.approval_action&&o._currUser===r._id&&!r.access&&"sequential"===a.type),p.xp6(1),p.Q6J("ngIf","--"!==r.approval_action&&o._currUser===r._id&&"any-one"!==a.type),p.xp6(1),p.Q6J("ngIf",r.approval_action&&o._currUser===r._id&&"any-one"===a.type&&!r.access),p.xp6(1),p.Q6J("ngIf",o._currUser!==r._id),p.xp6(2),p.Oqu(r.workflow_status)}}function F(e,t){if(1&e&&(p.TgZ(0,"p",10),p._uU(1),p.qZA(),p.TgZ(2,"table",22),p.TgZ(3,"thead",23),p.TgZ(4,"tr"),p.TgZ(5,"th",24),p._uU(6,"Users"),p.qZA(),p.TgZ(7,"th",24),p._uU(8,"Approval Action"),p.qZA(),p.TgZ(9,"th",24),p._uU(10,"Workflow Status"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(11,"tbody"),p.YNc(12,R,10,7,"ng-template",20),p.qZA(),p.qZA()),2&e){var r=t.$implicit,a=t.index;p.xp6(1),p.AsE("Level ",a+1," (",r.type_of_approval,")"),p.xp6(11),p.Q6J("ngForOf",r.approvers)}}function D(e,t){if(1&e&&p.YNc(0,F,13,3,"ng-template",20),2&e){var r=p.oxw(2);p.Q6J("ngForOf",r.statusLog)}}function E(e,t){if(1&e&&(p.TgZ(0,"p",10),p._uU(1),p.qZA()),2&e){var r=p.oxw(2);p.xp6(1),p.Oqu(r._finalResult)}}function V(e,t){if(1&e&&(p.TgZ(0,"div",8),p.YNc(1,D,1,1,"ng-template",21),p.YNc(2,E,2,1,"ng-template",21),p.qZA()),2&e){var r=p.oxw();p.xp6(1),p.Q6J("ngIf",r.statusLog.length>0),p.xp6(1),p.Q6J("ngIf",r._finalResult)}}var P,S,j=[{path:"",component:m,children:[{path:"",component:Z,data:{title:"Vendors"}},{path:"workflow-detail/:id",component:(P=function(){function t(r,a,o,n,i){var s=this;e(this,t),this._alert=r,this._auth=a,this._vendorProvider=o,this._activatedRoute=n,this._workflowProvider=i,this._level=1,this._currUser="",this._showWorkflow=!1,this._actions=["--","Approve","Reject","Reject & Remove from workflow"],this.statusLog=[],this.vendor_id=this._activatedRoute.snapshot.paramMap.get("id"),this._currUser=this._auth.getIdentity(),this.vendor_id&&this._vendorProvider.getVendor(this.vendor_id).subscribe(function(e){e.error||(s._vendorData=e.data,s.fetchWorkflow())})}return r(t,[{key:"ngOnInit",value:function(){}},{key:"fetchWorkflow",value:function(){var e=this,t=!0;this._workflowProvider.getWorklog(this.vendor_id).subscribe(function(r){if(!r.error){var a={type_of_approval:"Sequential Approvals",type:"sequential",approvers:[]};if(e.statusLog=[],e._vendorData.sequential_approvers.forEach(function(o){var n={_id:o._id,user:o.full_name,approval_action:"--",workflow_status:"--",access:t};if(e._workflowData=r.data,r.data.length>0){var i=e.verifyApproverAction("sequential",o._id);i.length>0&&(t=!0,n.access=t,n.approval_action=i[0].approval_action,n.workflow_status=i[0].workflow_status)}else t=!1;a.approvers.push(n)}),e.statusLog.push(a),e._showWorkflow=!0,r.data.length>0){var o=e.statusLog[0].approvers[e.statusLog[0].approvers.length-1];e.prepareLog(o.approval_action,o.workflow_status)}}})}},{key:"prepareLog",value:function(e,t){var r=this,a={type_of_approval:"",type:"",approvers:[]};if("--"!==e){if("Approve"===e)a.type_of_approval="Round-robin Approvals",a.type="round-robin",this._vendorData.round_robin_approvers.forEach(function(e){var o={_id:e._id,user:e.full_name,approval_action:"--",workflow_status:t,access:!0};if(r._workflowData.length>0){var n=r.verifyApproverAction("round-robin",e._id);n.length>0&&(o.approval_action=n[0].approval_action,o.workflow_status=n[0].workflow_status)}a.approvers.push(o)});else{var o=!0;a.type_of_approval="Any One Approvals",a.type="any-one",this._vendorData.any_one_approvers.forEach(function(e){var n={_id:e._id,user:e.full_name,approval_action:"--",workflow_status:t,access:o};if(r._workflowData.length>0){var i=r.verifyApproverAction("any-one",e._id);i.length>0&&(o=!o,n.approval_action=i[0].approval_action,n.workflow_status=i[0].workflow_status)}a.approvers.push(n)}),a.approvers.forEach(function(e){e.access=o})}if(this.statusLog.push(a),"round-robin"===a.type){var n=this.statusLog[this.statusLog.length-1].approvers[this.statusLog[this.statusLog.length-1].approvers.length-1];"Approve"===n.approval_action?this.statusLog[this.statusLog.length-1].approvers.every(function(e){return"Approve"===e.approval_action})&&(this._finalResult="Final Result: This workflow was executed successfully.",this.updateStatus()):"Reject"===n.approval_action?(this._finalResult="Final Result: This workflow was terminated.",this.updateStatus()):"Reject & Remove from workflow"===n.approval_action&&this.prepareLog(n.approval_action,n.workflow_status)}else"any-one"===a.type&&this.statusLog[this.statusLog.length-1].approvers.some(function(e){return"Approve"===e.approval_action})&&this.prepareLog("Approve","Active")}}},{key:"verifyApproverAction",value:function(e,t){return this._workflowData.filter(function(r){return r.user_id===t&&r.type_of_approval===e})}},{key:"updateLog",value:function(e,t){var r=this;this._workflowProvider.submitWorklog({vendor_id:this.vendor_id,user_id:this._currUser,type_of_approval:t,approval_action:e.target.value,workflow_status:"Reject"===e.target.value?"Terminated":"Active"}).subscribe(function(e){e.error||r.fetchWorkflow()})}},{key:"updateStatus",value:function(){var e=this;""===this._vendorData.workflow_status&&this._vendorProvider.updateVendor(this._vendorData._id,{workflow_status:this._finalResult}).subscribe(function(t){t.error||e._alert.success(t.message)})}}]),t}(),P.\u0275fac=function(e){return new(e||P)(p.Y36(l.c9),p.Y36(l.e8),p.Y36(l.mq),p.Y36(i.gz),p.Y36(l.zy))},P.\u0275cmp=p.Xpm({type:P,selectors:[["app-vendor-workflow"]],decls:18,vars:3,consts:[["header","",1,"card-header"],[4,"ngIf"],["body","",1,"card-body"],[1,"row"],[1,"col-md-4","col-sm-12","col-no-padding"],["class","info-container",4,"ngIf"],[1,"col-md-8","col-sm-12","col-no-padding","col-divider"],[1,"data-container"],[1,"col-sm-12","col-no-padding"],[1,"section-wrapper"],[1,"section-heading"],["type","button",1,"btn-datatable-2",3,"click"],[1,"mdi","mdi-reload","mdi-18px"],["class","col-sm-12 col-no-padding",4,"ngIf"],[1,"info-container"],[1,"task-wrap-container"],[1,"section-heading","mb-4"],[1,"keywords-container"],[1,"label"],[1,"main-menu"],["ngFor","",3,"ngForOf"],[3,"ngIf"],[1,"table","mb-8"],[1,"thead-dark"],["scope","col"],[1,"form-control","custom-select",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(p.TgZ(0,"app-ui-card"),p.TgZ(1,"div",0),p.YNc(2,x,2,1,"h3",1),p.qZA(),p.TgZ(3,"div",2),p.TgZ(4,"div",3),p.TgZ(5,"div",4),p.YNc(6,J,26,8,"div",5),p.qZA(),p.TgZ(7,"div",6),p.TgZ(8,"div",7),p.TgZ(9,"div",3),p.TgZ(10,"div",8),p.TgZ(11,"div",9),p.TgZ(12,"p",10),p._uU(13,"Workflow Status"),p.qZA(),p.TgZ(14,"button",11),p.NdJ("click",function(){return t.fetchWorkflow()}),p._UZ(15,"i",12),p._uU(16," Reload Workflow"),p.qZA(),p.qZA(),p.qZA(),p.YNc(17,V,3,2,"div",13),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&e&&(p.xp6(2),p.Q6J("ngIf",t._vendorData),p.xp6(4),p.Q6J("ngIf",t._vendorData),p.xp6(11),p.Q6J("ngIf",t._showWorkflow))},directives:[c.A,u.O5,u.sg,A.YN,A.Kr],pipes:[u.uU],styles:[".btn-datatable-2[_ngcontent-%COMP%]{right:0;top:-5px;position:absolute}.table[_ngcontent-%COMP%]   .thead-dark[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{width:33%}"]}),P),data:{title:"Vendor Workflow"}},{path:"create-vendor",component:b,data:{title:"Create Vendor"}}]}],z=function(){var t=function t(){e(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[i.Bz.forChild(j)],i.Bz]}),t}(),W=((S=function t(){e(this,t)}).\u0275fac=function(e){return new(e||S)},S.\u0275mod=p.oAB({type:S}),S.\u0275inj=p.cJS({imports:[[n.O,z]]}),S)}}])}();